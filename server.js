const express = require('express');
const axios = require('axios');
const bodyParser = require('body-parser');
require('dotenv').config();

const app = express();
const PORT = process.env.PORT || 3030;

app.use(bodyParser.json());
app.use(express.static('public'));

let userFormData = {}; // –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ –∞–Ω–∫–µ—Ç—ã

// üîπ –ü–µ—Ä–≤—ã–π —ç—Ç–∞–ø: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–∫–µ—Ç—ã
app.post('/process', async (req, res) => {
    try {
        const userMessage = req.body.message;
        console.log("üîµ –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∞–Ω–∫–µ—Ç—ã:", userMessage);

        const prompt1 = `
–í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∫–µ—Ç—É, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–µ –Ω–∞ –ø–æ–ª–Ω–æ—Ç—É –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å, –∞ –∑–∞—Ç–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –∫—Ä–∞—Ç–∫–æ–º –≤–∏–¥–µ:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ –∏–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
2. –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–π—Ç–µ –∞–Ω–∫–µ—Ç—É –≤ –∫—Ä–∞—Ç–∫–æ–º –≤–∏–¥–µ: 
   - –í–æ–ø—Ä–æ—Å: –û—Ç–≤–µ—Ç
   - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–º–µ—Ç–∫—É "–¢—Ä–µ–±—É–µ—Ç—Å—è –≤–≤–æ–¥".
   - –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –¥—Ä—É–≥–∏–µ –¥–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ dd.mm.yyyy (–µ—Å–ª–∏ –¥–∞–µ—Ç—Å—è –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç, –ø–µ—Ä–µ–¥–µ–ª–∞–π—Ç–µ –≤ –Ω—É–∂–Ω—ã–π).
   - –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω –∏–ª–∏ –Ω–µ–ª–æ–≥–∏—á–µ–Ω, –Ω–∞–ø–∏—à–∏—Ç–µ "–¢—Ä–µ–±—É–µ—Ç—Å—è –≤–≤–æ–¥".
   —Å–º–æ—Ç—Ä–∏ —Å—Ç–∞—Ç—É—Å —Ç—Ä—É–¥–æ–π—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Å—Ç—É–¥–µ–Ω—Ç –∏ —á—Ç–æ —Ç–æ —Å–≤—è–∑–∞–Ω–æ–µ —Å —ç—Ç–∏–º, —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–π –∏ —Å—Ç—É–¥–µ–Ω—Ç –≤–º–µ—Å—Ç–µ
   —Å–º–æ—Ç—Ä–∏ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –∏ –Ω–µ –∑–∞–ø—Ä–∞—â–∏–≤–∞–π –≤–≤–æ–¥–∞ —É –æ–∫–æ–Ω —Ä–∞–∑–≤–∏–ª–æ–∫ –¥–æ–ø—É—Å—Ç–∏–º –¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å: –∏ —Ç–∞–º –æ–Ω –ø–µ—Ä–µ—á—Å–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ –µ—Å—Ç—å –Ω–µ –∑–∞–ø—Ä–∞—â–∏–≤–∞–π —É —Å–∞–º–æ–≥–æ —Ç–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å –≤–≤–æ–¥–∞ –∏ —Ç–¥ —Ç–ø, —Ç–∞–∫–∂–µ —Å –¥–µ—Ç—å–º–∏ —Ç–æ –µ—Å—Ç—å —Ä–µ–±–µ–Ω–æ–∫ 1 –∏ —Ç–¥ –∏ —Ç–ø –∏ —Ç–∞–∫ —Å –¥—Ä—É–≥–∏–º–∏ –≤–æ–æ–±—â–µ –Ω–∏–∫–æ–≥–¥–∞
–ê —Ç–∞–∫–∂–µ –ø—Ä–∏ –≤—ã–≤–æ–¥–µ **–Ω–µ –≤—ã–≤–æ–¥–∏ —ç—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ : –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –°–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ, –î–µ—Ç–∏, –ê–¥—Ä–µ—Å –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è, –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –¢—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –§–∏–Ω–∞–Ω—Å—ã, –¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å, –ò—Å—Ç–æ—Ä–∏—è –ø–æ–µ–∑–¥–æ–∫, –°–æ–ø—Ä–æ–≤–æ–∂–¥–∞—é—â–∏–µ –∏ –∑–∞–≤–∏—Å–∏–º—ã–µ –ª–∏—Ü–∞, –í–∏–∑–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è, –∞ –≤—ã–≤–æ–¥–∏ —Ç–æ–ª—å–∫–æ **–≤–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –Ω–∏—Ö**.
–ò –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ –Ω–µ –ø–∏—à–∏ –≤ —á–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –û—à–∏–±–∫–∞: –∏ —Ç–¥ —Ç–ø —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–µ –≤—ã–≤–æ–¥–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 
"–¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å" –Ω–µ –∑–∞–ø—Ä–∞—â–∏–≤–∞–π –≤–≤–æ–¥ —Å—é–¥–∞ –Ω–∏–∫–æ–≥–¥–∞ –∏–º–µ–Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ –æ–∫–Ω–∞ –∏ —á—Ç–æ –≤–Ω—É—Ç—Ä–∏ —Ç–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –µ—Å–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–æ
–ò –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –∫–∞–∂–¥—ã–π –∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π –Ω–∏—á–µ–≥–æ
–ï—Å–ª–∏ –∞–¥—Ä–µ—Å—Å –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è –º–µ–Ω—å—à–µ 2 –ª–µ—Ç —Ç–æ–≥–¥–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–π —ç—Ç–∏ –ø–æ–ª—è
ÔÇß –£–ª–∏—Ü–∞ –∞–¥—Ä–µ—Å—Å–∞ –≤ –∫–æ—Ç—Ä–æ–º –ø—Ä–æ–∂–∏–≤–∞–ª–∏ –º–µ–Ω—å—à–µ 2 –ª–µ—Ç: –ú—ã–Ω–±–∞–µ–≤–∞ 85
ÔÇß –ì–æ—Ä–æ–¥ –∞–¥—Ä–µ—Å—Å–∞ –≤ –∫–æ—Ç—Ä–æ–º –ø—Ä–æ–∂–∏–≤–∞–ª–∏ –º–µ–Ω—å—à–µ 2 –ª–µ—Ç: –ê–ª–º–∞—Ç—ã
ÔÇß –°—Ç—Ä–∞–Ω–∞ –∞–¥—Ä–µ—Å—Å–∞ –≤ –∫–æ—Ç—Ä–æ–º –ø—Ä–æ–∂–∏–≤–∞–ª–∏ –º–µ–Ω—å—à–µ 2 –ª–µ—Ç: –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω
ÔÇß –ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å –∞–¥—Ä–µ—Å—Å–∞ –≤ –∫–æ—Ç—Ä–æ–º –ø—Ä–æ–∂–∏–≤–∞–ª–∏ –º–µ–Ω—å—à–µ 2 –ª–µ—Ç: 050000
ÔÇß –ü–µ—Ä–∏–æ–¥ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏–µ (–¥–¥.–º–º.–≥–≥–≥–≥-–¥–¥.–º–º.–≥–≥–≥–≥): 3 —Å–µ–Ω—Ç—è–±—Ä—è 2021 ‚Äì 1 —Ñ–µ–≤—Ä–∞–ª—è 2025
–ï—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –ø–∏—à–µ—Ç –¥–∞—Ç—ã —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ —Å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è–º–∏ –±–µ—Ä–∏ –≤ —É—á–µ—Ç —á—Ç–æ –æ–Ω –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ –¥–∞—Ç—ã —Å 2015 –ø–æ 2025.

–°–º–æ—Ç—Ä–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ–∫–Ω–æ –¥–µ—Ç–µ–π —Ç–µ–ø–µ—Ä—å:
    –ü–µ—Ä–≤–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ '–°–∫–æ–ª—å–∫–æ —É –≤–∞—Å –¥–µ—Ç–µ–π': —á–∏—Å–ª–æ, (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–¥–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Ä–µ–±–µ–Ω–∫–∞ –¥–∞–Ω–Ω—ã–µ –ø–æ –æ—á–µ—Ä–µ–¥–∏ —Ç–æ –µ—Å—Ç—å —Å–Ω–∞—á–∞–ª–∞ –æ–¥–Ω–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ –∏ –≤—Å–µ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ (–ò–º—è –§–∞–º–∏–ª–∏—è –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –ü—Ä–æ–∂–∏–≤–∞–µ—Ç –ª–∏ —Å –≤–∞–º–∏ –ü–æ–µ–¥–µ—Ç –ª–∏ —Å –≤–∞–º–∏ (–µ—Å–ª–∏ –¥–∞ —Ç–æ–≥–¥–∞ –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–æ–º–µ—Ä)), –∑–∞—Ç–µ–º –¥—Ä—É–≥–æ–≥–æ –∏ –µ–≥–æ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ)
    –ó–∞—Ç–µ–º —Ç—ã –ø–µ—Ä–µ–¥–∞—à—å —ç—Ç–æ –≤–≤–∏–¥–µ –†–µ–±–µ–Ω–æ–∫1 –∏ –≤—Å–µ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ, –∑–∞—Ç–µ–º –†–µ–±–µ–Ω–æ–∫2 –∏ –≤—Å–µ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ —Ç–æ –µ—Å—Ç—å –ò–º—è —Ñ–∞–º–∏–ª–∏—è –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –ø—Ä–æ–∂–∏–≤–∞–µ—Ç –ª–∏ —Å –≤–∞–º–∏ –ø–æ–µ–¥–µ—Ç –ª–∏ —Å –≤–∞–º–∏ –∏ –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–æ–º–µ—Ä –∏ –∫–æ–≥–¥–∞ –≤–≤–æ–¥—è—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ —Ç–æ —Å–ª–æ–≤–∞—Ä—å –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–µ–±–µ–Ω–∫–µ –∏ —Å–ø–∏—Å–∫–æ —Ç–æ–∂–µ –Ω–∞ –Ω–µ–º –∏ —Ç–¥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π.




–ù–µ –≤—ã–≤–æ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ "–î–µ—Ç–∞–ª–∏ –ø–æ–µ–∑–¥–æ–∫", –∞ –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–µ–∑–¥–∫–∞—Ö.
–≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ –Ω–µ –≤—ã–≤–æ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
üìã **–ê–Ω–∫–µ—Ç–∞:**
${userMessage}
    `;

        const apiResponse = await axios.post(
            'https://api.openai.com/v1/chat/completions',
            {
                model: 'gpt-4o',
                messages: [
                    { role: "system", content: "–¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–Ω–∫–µ—Ç. –§–æ—Ä–º–∞—Ç–∏—Ä—É–π –∞–Ω–∫–µ—Ç—É –≤ –∫—Ä–∞—Ç–∫–æ–º –≤–∏–¥–µ –∏ —É–∫–∞–∑—ã–≤–∞–π –æ—à–∏–±–∫–∏." },
                    { role: "user", content: prompt1 }
                ],
                temperature: 0.3,
            },
            {
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${process.env.OPENAI_API_KEY}` }
            }
        );

        userFormData = apiResponse.data.choices[0].message.content;
        console.log("üü¢ –ê–Ω–∫–µ—Ç–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:", userFormData);

        res.json({ reply: userFormData });
    } catch (error) {
        console.error("üö® –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∞–Ω–∫–µ—Ç—ã:", error.response ? error.response.data : error.message);
        res.status(500).json({ reply: '–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.' });
    }
});

// üîπ –í—Ç–æ—Ä–æ–π —ç—Ç–∞–ø: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–Ω–∫–µ—Ç—ã –≤ JSON
app.post('/finalProcess', async (req, res) => {
    try {
        const today = new Date();
        today.setMonth(today.getMonth() + 2); // –î–æ–±–∞–≤–ª—è–µ–º 2 –º–µ—Å—è—Ü–∞

        const day = today.getDate();
        const month = today.getMonth() + 1; // –ú–µ—Å—è—Ü—ã 0-–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –ø–æ—ç—Ç–æ–º—É –¥–æ–±–∞–≤–ª—è–µ–º 1
        const year = today.getFullYear();

        const formattedDate = `day: ${day}, month: ${month}, year: ${year}`;

        let finalFormData = req.body.updatedForm || userFormData;

        if (!finalFormData) {
            console.error("üö® –û—à–∏–±–∫–∞: –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.");
            return res.status(400).json({ reply: '–û—à–∏–±–∫–∞: –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.' });
        }

        console.log("üîµ –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–Ω–∫–µ—Ç—ã –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É:", finalFormData);

        const prompt2 = `
–¢—ã –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∞–Ω–∫–µ—Ç—É –≤ JSON-—Ñ–æ—Ä–º–∞—Ç "–∫–ª—é—á: –∑–Ω–∞—á–µ–Ω–∏–µ".  
üîπ **–í–ê–ñ–ù–û:**  
- –í—ã–≤–µ–¥–∏ **–¢–û–õ–¨–ö–û JSON** –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤.  
- –ò—Å–ø–æ–ª—å–∑—É–π **–¢–û–õ–¨–ö–û –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –∫–ª—é—á–∏**, –Ω–∞–ø—Ä–∏–º–µ—Ä: "email", "first_name", "passport_number".  
- **–ò–≥–Ω–æ—Ä–∏—Ä—É–π –ø—É—Å—Ç—ã–µ –∏–ª–∏ –Ω–µ–Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**.  
- –ù–µ –ø—Ä–æ–ø—É—Å–∫–∞–π –≤–æ–æ–±—â–µ –Ω–∏–∫–∞–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –Ω–µ —É–±–∏—Ä–∞–π –∏—Ö –∏—Å–ø–æ–ª—å–∑—É–π –≤—Å–µ —Ç–æ —á—Ç–æ –¥–∞–Ω–æ
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –¥–µ—Ç–µ–π (–µ—Å–ª–∏ children_count(—Å–∫–æ–ª—å–∫–æ —É –≤–∞—Å –¥–µ—Ç–µ–π: —á–∏—Å–ª–æ) > 0, —Å–æ–∑–¥–∞–π –º–∞—Å—Å–∏–≤ dependants) –∞ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é hasDependants_described = true. –≤—ã–≤–æ–¥–∏ —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∞ –ø—Ä–æ—Å—Ç–æ –±–µ—Ä–∏ –≤ —É—á–µ—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, –∞ –µ—Å–ª–∏ (—Å–∫–æ–ª—å–∫–æ —É –≤–∞—Å –¥–µ—Ç–µ–π: —á–∏—Å–ª–æ) = 0 –∏–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ—Ç—É –∏–ª–∏ –Ω–µ—Ç, —Ç–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è hasDependants_described = false
- –¢–∞–∫–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤—Å–µ –æ—Ç–≤–µ—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã (–∂–µ–Ω–∞ –¥–µ—Ç–∏ –∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ —á—Ç–æ –¥–∞–Ω–æ), –µ—Å–ª–∏ —Ç–µ–±–µ –Ω–µ –¥–∞–Ω–∞ —á–µ—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∫–∞–∫ –∏—Ö –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–π –Ω–æ–≤—ã–µ —Å–∞–º
- –ê —Ç–∞–∫–∂–µ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ –æ–±—Ä–∞–±–æ—Ç–∞–π –æ—Ç–≤–µ—Ç—ã –∏ –ø–µ—Ä–µ–≤–µ–¥–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫ –∞ —Ç–∞–∫–∂–µ –≤—Å–µ –æ—Ç–≤–µ—Ç—ã –∏–º–µ–Ω–∞ —Ñ–∞–º–∏–ª–∏—è –∞–¥—Ä–µ—Å—Å–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ —É–ª–∏—Ü –≥–æ—Ä–æ–¥–∞ –∏ —Å—Ç—Ä–∞–Ω—ã –ø–µ—Ä–µ–≤–æ–¥–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫ 
- –¥–µ–ª–∞–π —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –ø–æ–¥ —Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ—Ç–æ—Ä—ã–µ —É–ø–æ–º—è–Ω–æ—Ç—ã –∏ –¥–µ–ª–∞–π –∏—Ö —Å —Ç–∞–∫–∏–º –∂–µ –Ω–∞–∑–≤–∞–Ω–∏–µ–º, –∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ—Ç–æ—Ä—ã–µ —è –Ω–µ —É–ø–æ–º–Ω—è–ª —Å–∞–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—à—å –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –∏–∑—Ö–æ–¥—è –æ—Ç –∞–Ω–∫–µ—Ç—ã
üìå **–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:**  
\`\`\`json
{
  "email": "example@email.com",
  "telephoneNumber": "+77779990000",
  "givenNameFirst": "–ò–≤–∞–Ω",
  "familyNameFirst": "–ü–µ—Ç—Ä–æ–≤",
  "sex": M - for male and F - for female,
  "selectedMarriedStatus": S - single, M - maried, D - divorced,
  "outOfCountryAddress": "–∑–¥–µ—Å—å —É–ª–∏—Ü–∞",
  "townCity": "–≥–æ—Ä–æ–¥",
  "postalCode": "–ø–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å",
  "countryRef": "–°—Ç—Ä–∞–Ω–∞",

  givenName = 'Alaska' (–ò–º—è —Å—É–ø—Ä—É–≥);
  familyName = 'Adams' (–§–∞–º–∏–ª–∏—è —Å—É–ø—Ä—É–≥–∞);
  partnerDateOfBirth = { day: "01", month: "01", year: "2002" } (–¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è —Å—É–ø—Ä—É–≥–∞/–∏);
  partnerCountry = 'Kazakhstan' –≤—Å–µ–≥–¥–∞ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω;
  travellingWithYou = true (–ü–æ–µ–¥—É—Ç —Å –≤–∞–º–∏ –≤ –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—é –µ—Å–ª–∏ –¥–∞ —Ç–æ true, no = false);
  partnerPassportNumber = –Ω–æ–º–µ—Ä –ø–∞—Å—Å–ø–æ—Ä–∞—Ç —Å—É–ø—Ä—É–≥–∞/–∏;



  "selectedTime": {"number": "3", "unit": "years"} (—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–∏–∂–≤–∞–µ—Ç–µ –≤ –Ω–µ–º), ,
  "statusOfOwnership" = {
    OWNED: "ownershipCategory_own",
    RENTED: "ownershipCategory_rent",
  }  –∫–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥–æ–º –µ—Å–ª–∏ —Å–µ–±–µ —Ç–æ–≥–¥–∞ owned = "ownershipCategory_own", –µ—Å–ª–∏ –∞—Ä–µ–Ω–¥–∞ —Ç–æ–≥–¥–∞ rented ="ownershipCategory_rent",


  –µ—Å–ª–∏ selectedTime –º–µ–Ω—å—à–µ 2 –ª–µ—Ç —Ç–æ–≥–¥–∞ —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–∂–µ
    "overseasAddress_line1": "astana botan",
    "overseasAddress_townCity": "astana",
    "overseasRegion": "astana",
    "overseasPostCode": "AB1 0AA",
    "startDateAtAddress": {"month": "02", "year": "2019"},
    "endDateAtAddress": {"month": "04", "year": "2020"},
  
  "passportNumber": "123456789" (–Ω–æ–º–µ—Ä –∑–∞–≥—Ä–∞–Ω–∏—á–Ω–æ–≥–æ –ø–∞—Å—Å–ø–æ—Ä—Ç–∞),
  "issuingAuthority": "Astana" (–æ—Ä–≥–∞–Ω –≤—ã–¥–∞–≤—à–∏–π –∑–∞–≥—Ä–∞–Ω –ø–∞—Å—Å–ø–æ—Ä—Ç –¥–æ–∫—É–º–µ–Ω—Ç),
  "issueDate": {"day": "01", "month": "01", "year": "2020"} –ø–µ—Ä–∏–æ–¥,
  "expiryDate": {"day": "01", "month": "01", "year": "2030"} –ø–µ—Ä–∏–æ–¥,
  "passportId": "123456789" ID,
  "issuingAuthorityId": "Astana",
  "issueDateId": {"day": "01", "month": "01", "year": "2020"},
  "expiryDateId": {"day": "01", "month": "01", "year": "2030"},
  
  "countryOfBirth": –≤–æ–∑—å–º–∏ —Å—Ç—Ä–∞–Ω—É —Å –ø–æ–ª—è –º–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è,
  "placeOfBirth":  –≤–æ–∑—å–º–∏ –≥–æ—Ä–æ–¥ —Å –ø–æ–ª—è –º–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è,
  "dateOfBirth": {"day": "15", "month": "05", "year": "1990"},
  "selectedStatuses" = (–°—Ç–∞—Ç—É—Å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
  —Å–º–æ—Ç—Ä–∏ –∞ —Ç–∞–∫–∂–µ –≤ –∞–Ω–∫–µ—Ç–µ –∫–æ–≥–¥–∞ —é–∑–µ—Ä –≤–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç—É—Å —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ–Ω –º–æ–∂–µ—Ç –Ω–∞–ø–∏—Å—Å–∞—Ç—å –≤–º–µ—Å—Ç–µ —Å—Ä–∞–∑—É —Ä–∞–±–æ—Ç–∞—é –∏ —Å—Ç—É–¥–µ–Ω—Ç –ª–∏–±–æ —á—Ç–æ —Ç–æ –≤ —ç—Ç–æ–º –¥—É—Ö–µ,
  —Ç–æ –µ—Å—Ç—å —Å—Ä–∞–∑—É 2 –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Ç–æ —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å—Ç—É–¥–µ–Ω—Ç —Å–º–æ—Ç—Ä–∏ –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–Ω –≤—ã–≤–µ–¥–∏—Ç selectedStatuses —Å–ø–∏—Å–æ–∫ –∏–∑ –¥–≤—É—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ç–æ –µ—Å—Ç—å (selectedStatuses = ["status_employed","status_employed"])
    if EMPLOYED: ["status_employed"],
    if SELF_EMPLOYED: ["status_self-employed"],
    if STUDENT: ["status_student"],
    if RETIRED: ["status_retired"],
    if UNEMPLOYED: ["status_unemployed"]
  
  if selectedStatuses = EMPLOYED{
    "employerName": "Tech Corp", (–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏)
    "employerAddress": "123 Tech Street" (–ø–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å—Å —É–ª–∏—Ü–∞ –∏ –≥–æ—Ä–æ–¥),
    "employerCity": "London" –≥–æ—Ä–æ–¥,
    "employerState": "London" –≥–æ—Ä–æ–¥,
    "employerPostCode": "SW1A 1AA" –≤–æ–∑—å–º–∏ –ø–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å —Å –æ—Ç–≤–µ—Ç–∞,
    "employerCountry": "Kazakhstan" —Å—Ç—Ä–∞–Ω–∞,
    "employerPhone": {"code": "44", "number": "7123456789"} –≤–æ–∑—å–º–∏ –∫–æ–¥ –∫–∞–∫ –ø–µ—Ä–≤—É—é —Ü–∏—Ñ—Ä—É –Ω–æ–º–µ—Ä–∞ –∏ –Ω–æ–º–µ—Ä –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã,
    "workingDate": {"month": "01", "year": "2020"} –ø–µ—Ä–∏–æ–¥ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã,
    "jobTitle": "Developer" –¥–æ–ª–∂–Ω–æ—Å—Ç—å,
    "earnValute": "KZT" –≤–∞–ª—é—Ç–∞ –±–µ—Ä–∏ –µ–µ –≤ –∫–æ–Ω—Ü–µ –≤ –æ–∫–Ω–µ –¥–æ—Ö–æ–¥–∞, 
    "earnAmount": –±–µ—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –æ–∫–Ω–∞ "–°–∫–æ–ª—å–∫–æ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ –≤ –º–µ—Å—è—Ü?",
    "jobDescription": "Software development" –≥–µ–Ω–µ—Ä–∏—Ä—É–π 2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏—Å—Ö–æ–¥—è –∏–∑ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–¥—É–º–∞–π —á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å,
  }

  if selectedStatuses = SELF_EMPLOYED{
    "jobTitle": "Developer" –±–µ—Ä–∏ —Å –ø–æ–ª—è –ß–µ–º –∑–∞–Ω–∏–º–∞–µ—Ç–µ—Å—å?,
    "earnValute": "KZT" , 
    "earnAmount": –±–µ—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –æ–∫–Ω–∞ "–°–∫–æ–ª—å–∫–æ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ –≤ –º–µ—Å—è—Ü?",
    "jobDescription": "Software development" –≥–µ–Ω–µ—Ä–∏—Ä—É–π 2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏—Å—Ö–æ–¥—è –∏–∑ jobTitle –∏ –ø—Ä–∏–¥—É–º–∞–π —á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å,
  }

  "moneyInBankAmount" = –±–µ—Ä–∏ —Å –ø–æ–ª—è —Å–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –±—É–¥–µ—Ç –Ω–∞ —Å—á–µ—Ç—É (–∞ –∑–∞—Ç–µ–º –¥–µ–ª–∏ –Ω–∞ 635) –∏ –∑–∞—Å–æ–≤—ã–π –≤ –∫–æ–≤—ã—á–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ

  "payingForYourVisit" = –µ—Å–ª–∏ –∫—Ç–æ —Ç–æ –ø–ª–∞—Ç–∏—Ç –∑–∞ —Ç–µ–±—è —Ç–æ–≥–¥–∞ true, –µ—Å–ª–∏ —Å–∞–º –ø–ª–∞—Ç–∏—à—å –∑–∞ –ø–æ–µ–∑–¥–∫—É —Ç–æ–≥–¥–∞ false, –±–µ—Ä–∏ –æ—Ç–≤–µ—Ç —Å –ø–æ–ª—è –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –ø–æ–µ–∑–¥–∫—É
  

  "whoWillBePaying" = (–µ—Å–ª–∏ payingForYourVisit = true —Ç–æ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –≤–æ—Ç —Ç–∞–∫: {
    –µ—Å–ª–∏ –∫—Ç–æ —Ç–æ –∫–æ–≥–æ —è –∑–Ω–∞–∫—é —Ç–æ–≥–¥–∞ –≤–≤–æ–¥–∏ —ç—Ç–æ: "whoIsPayingRef_someoneIKnow",
    –µ—Å–ª–∏ –º–æ—è –∫–æ–º–ø–∞–Ω–∏—è –∏–ª–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ç–æ–≥–¥–∞ –≤–≤–æ–¥–∏ —ç—Ç–æ: "whoIsPayingRef_myEmployerOrCompany",
    –µ—Å–ª–∏ –¥—Ä—É–≥–∞—è –∫–æ–º–ø–∞–Ω–∏—è –∏–ª–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ç–æ–≥–¥–∞ –≤–≤–æ–¥–∏ —ç—Ç–æ:  "whoIsPayingRef_otherEmployerOrCompany",
  }, –∞ –µ—Å–ª–∏ payingForYourVisit = false, —Ç–æ–≥–¥–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –±—É–¥–µ—Ç)

  if whoWillBePaying = whoIsPayingRef_someoneIKnow{
    payeeName = "–∏–º—è" –±–µ—Ä–∏ —Å –ø–æ–ª—è –∏–º—è —Ç–æ–≥–æ –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç;
    address_line1 = "Astana" –±–µ—Ä–∏ —Å –ø–æ–ª—è –∏–º—è –ê–¥—Ä–µ—Å —Å –≥–æ—Ä–æ–¥–æ–º –∏–Ω–¥–µ–∫—Å–æ–º –∏ —Å—Ç—Ä–∞–Ω–æ–π —á–µ–ª–æ–≤–µ–∫–∞ –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç;
    address_townCity = "Astana"  –±–µ—Ä–∏ —Å –ø–æ–ª—è –∏–º—è –ê–¥—Ä–µ—Å —Å –≥–æ—Ä–æ–¥–æ–º –∏–Ω–¥–µ–∫—Å–æ–º –∏ —Å—Ç—Ä–∞–Ω–æ–π —á–µ–ª–æ–≤–µ–∫–∞ –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –±–µ—Ä–∏ –≥–æ—Ä–æ–¥;
    address_province = "Astana"  –±–µ—Ä–∏ —Å –ø–æ–ª—è –∏–º—è –ê–¥—Ä–µ—Å —Å –≥–æ—Ä–æ–¥–æ–º –∏–Ω–¥–µ–∫—Å–æ–º –∏ —Å—Ç—Ä–∞–Ω–æ–π —á–µ–ª–æ–≤–µ–∫–∞ –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –±–µ—Ä–∏ –≥–æ—Ä–æ–¥;
    address_postalCode = "AB1 0AA"  –±–µ—Ä–∏ —Å –ø–æ–ª—è –∏–º—è –ê–¥—Ä–µ—Å —Å –≥–æ—Ä–æ–¥–æ–º –∏–Ω–¥–µ–∫—Å–æ–º –∏ —Å—Ç—Ä–∞–Ω–æ–π —á–µ–ª–æ–≤–µ–∫–∞ –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –±–µ—Ä–∏ –ø–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å;
    address_countryRef_ui = "Kazakhstan"  –±–µ—Ä–∏ —Å –ø–æ–ª—è –∏–º—è –ê–¥—Ä–µ—Å —Å –≥–æ—Ä–æ–¥–æ–º –∏–Ω–¥–µ–∫—Å–æ–º –∏ —Å—Ç—Ä–∞–Ω–æ–π —á–µ–ª–æ–≤–µ–∫–∞ –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –±–µ—Ä–∏ —Å—Ç—Ä–∞–Ω—É —Å —Ç–æ–≥–æ –∂–µ –ø–æ–ª—è;
    choosenValue = "GBP";
    choosenAmount = –±–µ—Ä–∏ —Å –ø–æ–ª—è —Å—É–º–º—ã –æ–ø–ª–∞—Ç—ã –≤ –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –ø–æ–µ–∑–¥–∫—É(–∞ –∑–∞—Ç–µ–º –¥–µ–ª–∏ –Ω–∞ 635) –∏ –∑–∞—Å–æ–≤—ã–π –≤ –∫–æ–≤—ã—á–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ;
    descriptionWhyAreTheyHelping = –±–µ—Ä–∏ –æ—Ç–≤–µ—Ç —Å –ø–æ–ª—è –ø—Ä–∏—á–∏–Ω–∞ –≤ —Å–µ–∫—Ü–∏–∏ –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç, –∞ —Ç–∞–∫–∂–µ –ª–æ–≥–∏—á–µ—Å–∫–∏ –¥–æ–ø–ª–Ω–∏ –µ–µ —Å–∞–º –Ω–∞ 2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è;
  }
  
  if whoWillBePaying = whoIsPayingRef_myEmployerOrCompany{
    choosenValue = "GBP"
    choosenAmount = –±–µ—Ä–∏ —Å –ø–æ–ª—è –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –ø–æ–µ–∑–¥–∫—É –µ—Å–ª–∏ –∫–æ–º–ø–∞–Ω–∏—è —Å—É–º–º–∞ (–∞ –∑–∞—Ç–µ–º –¥–µ–ª–∏ –Ω–∞ 635) –∏ –∑–∞—Å–æ–≤—ã–π –≤ –∫–æ–≤—ã—á–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ;
    descriptionWhyAreTheyHelping = –±–µ—Ä–∏ —Å –ø–æ–ª—è –∫—Ç–æ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –ø–æ–µ–∑–¥–∫—É –µ—Å–ª–∏ –∫–æ–º–ø–∞–Ω–∏—è –ø–æ—á–µ–º—É –ø–ª–∞—Ç—è—Ç;
  }
  
  
  
  –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–π –≤–æ—Ç —ç—Ç–∏ –∫–ª—é—á–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö –¥–∞–Ω–Ω—ã—Ö
  arrivalDay = –±–µ—Ä–∏ ${formattedDate}  –±–µ—Ä–∏ –≤ –∫–∞–≤—ã—á–∫–∏;
  arrivalMonth = –±–µ—Ä–∏ –¥–∞—Ç—É –∏–∑ arrivalDay –∏ –≤–æ–¥–∏ —Å—é–¥–∞ –º–µ—Å—è—Ü –∞  –∏ –±–µ—Ä–∏ –≤ –∫–∞–≤—ã—á–∫–∏;
  arrivalYear = –±–µ—Ä–∏ –¥–∞—Ç—É –∏–∑ arrivalDay –∏ –≤–æ–¥–∏ —Å—é–¥–∞ –≥–æ–¥ –∞  –∏ –±–µ—Ä–∏ –≤ –∫–∞–≤—ã—á–∫–∏;
  departureDay = –±–µ—Ä–∏ –¥–∞—Ç—É –∏–∑ arrivalDay –∏ –¥–æ–±–∞–≤—å –¥–Ω–∏ (–æ—Ç 12 –¥–æ 16 –∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Ä–∞–Ω–æ–¥–æ–º–Ω–æ) –∫–æ—Ç–æ—Ä–∞—è —Å–µ–≥–æ–¥–Ω—è –∏ –≤–æ–¥–∏ —Å—é–¥–∞ –¥–µ–Ω—å –∏ –±–µ—Ä–∏ –≤ –∫–∞–≤—ã—á–∫–∏;;
  departureMonth = –±–µ—Ä–∏ –¥–∞—Ç—É –∏–∑ departureDay –∏ –≤–æ–¥–∏ —Å—é–¥–∞ –º–µ—Å—è—Ü –∞  –∏ –±–µ—Ä–∏ –≤ –∫–∞–≤—ã—á–∫–∏;
  departureYear = –±–µ—Ä–∏ –¥–∞—Ç—É –∏–∑ departureDay –∏ –≤–æ–¥–∏ —Å—é–¥–∞ –º–µ—Å—è—Ü –∞  –∏ –±–µ—Ä–∏ –≤ –∫–∞–≤—ã—á–∫–∏;
  
  - –ï—Å–ª–∏ children_count –±–æ–ª—å—à–µ 0, —Å–æ–∑–¥–∞–π –º–∞—Å—Å–∏–≤ dependants, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç **–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞**. –∞ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é hasDependants_described = true
   –µ—Å–ª–∏ (—Å–∫–æ–ª—å–∫–æ —É –≤–∞—Å –¥–µ—Ç–µ–π: —á–∏—Å–ª–æ) = 0 –∏–ª–∏ –æ—Ç–≤–µ—Ç –Ω–µ—Ç—É –∏–ª–∏ –Ω–µ—Ç, —Ç–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è hasDependants_described = false
- –ö–∞–∂–¥—ã–π —Å–ª–æ–≤–∞—Ä—å –≤ dependants –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å:  
  - givenName, familyName, dateOfBirth, relationship (child)
  - livingWithYou, travellingWithYou
  - –ï—Å–ª–∏ travellingWithYou = true, –¥–æ–±–∞–≤—å passportNumber
  
–ü—Ä–∏–º–µ—Ä:  

  "dependants": [
    {
      "givenName": "–ê–Ω–Ω–∞",
      "familyName": "–ü–µ—Ç—Ä–æ–≤–∞",
      "dateOfBirth": { "day": "15", "month": "05", "year": "2015" },
      "relationship": "child",
      "livingWithYou": true,
      "travellingWithYou": false
    },
    {
      "givenName": "–ê–ª–µ–∫—Å–µ–π",
      "familyName": "–ü–µ—Ç—Ä–æ–≤",
      "dateOfBirth": { "day": "20", "month": "07", "year": "2018" },
      "relationship": "child",
      "livingWithYou": true,
      "travellingWithYou": true,
      "passportNumber": "A12345678"
    }
  ]




 –¢–µ–ø–µ—Ä—å –ø–æ–π–¥—É—Ç –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω—ã(–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±—ã–ª–∏ –≤ –ê–≤—Å—Ç—Ä–∞–ª–∏–∏, –®–≤–µ–π—Ü–∞—Ä–∏–∏, –°–®–ê, –ö–∞–Ω–∞–¥–µ, –ù–æ–≤–æ–π –ó–µ–ª–∞–Ω–¥–∏–∏, –ï–≤—Ä–æ–ø–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ª–µ—Ç?) –∏ —Ç—ã –±—É–¥–µ—à—å –∏—Ö –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–æ—Ç —Ç–∞–∫ –∫–∞–∫ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π 
  worldTravelCount = –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å –∫–æ–ª-–≤–æ —Å—Ç—Ä–∞–Ω –ø–æ—Å–µ—Ç–∏–≤—â–∏—Ö –∏–∑ —Å–ø–∏—Å–∫–∞ travels   —É –Ω–∞—Å –∏–¥—É—Ç —Ç–∞–∫–∏–µ —Ä–∞–∑–≤–∏–ª–∫–∏ –∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–∞–Ω –≥–¥–µ –æ–Ω –ø–æ–±—ã–≤–∞–ª —É –Ω–∞—Å –±—É–¥–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è isTraveledCountries –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω—É—é —Ç–æ –µ—Å—Ç—å
    –æ–Ω –±—É–¥–µ—Ç –±—Ä–∞—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –æ—Ç—Å—é–¥–∞
    –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±—ã–ª–∏ –≤ –ê–≤—Å—Ç—Ä–∞–ª–∏–∏, –®–≤–µ–π—Ü–∞—Ä–∏–∏, –°–®–ê, –ö–∞–Ω–∞–¥–µ, –ù–æ–≤–æ–π –ó–µ–ª–∞–Ω–¥–∏–∏, –ï–≤—Ä–æ–ø–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ª–µ—Ç? –∏ –æ–Ω –≤–æ–¥–∏—Ç —á–∏—Å–ª–æ —Å–º–æ—Ç—Ä–∏ –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç 
    0 —Ä–∞–∑ = 'bandRef_0',
    1 —Ä–∞–∑ = 'bandRef_1',
    2-5 —Ä–∞–∑ = 'bandRef_2'
    –∏ –±–æ–ª—å—à–µ 6 —Ä–∞–∑ = 'bandRef_6'
    —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ —è –æ—Ç–≤–µ—Ç–∏–ª 4 —Ä–∞–∑–∞ —Ç–æ–≥–¥–∞ –±—É–¥–µ—Ç 
    isTraveledCountries: bandRef_2 –∏ —Ç–¥ –∏ —Ç–ø –∏ –∑–∞—Ç–µ–º –ø–æ–π–¥–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω –∏ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∫ —Å–Ω–∏–∑—É
    –∑–∞—Ç–µ–º –æ–Ω –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∏ —Å–ª–æ–≤–∞—Ä–µ–π –≤ —Ç–µ—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –≥–¥–µ –æ–Ω –±—ã–ª –¥–æ–ø—É—Å—Ç–∏–º –æ–Ω –≤–≤–µ–ª –∫–æ–ª-–≤–æ —Å—Ç—Ä–∞–Ω—ã –∏ –±—É–¥–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ —Å–ª–æ–≤–∞—Ä–µ–π –Ω–∞ –∫–∞–∂–¥—É—é –∏–∑ —Å—Ç—Ä–∞–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    
    –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    reason = {
      TOURISM: 'reasonForVisit_tourism',
      WORK:'reasonForVisit_tourism',
      STUDY:'reasonForVisit_tourism',
      TRANSIT:'reasonForVisit_tourism',
      OTHER:'reasonForVisit_tourism'
          }

      –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å—Ç—Ä–∞–Ω—ã —Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ –±—É–¥–µ—Ç –æ–¥–Ω–∞ –∏–∑ —ç—Ç–∏—Ö —Å—Ç—Ä–∞–Ω —Ç–æ –∫–ª—é—á country –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∞ –µ—Å–ª–∏ –Ω–∏ –æ–¥–Ω–æ–π –∏–∑ —Å—Ç—Ä–∞–Ω—ã –Ω–µ—Ç —Ç–æ–≥–¥–∞ –æ—Ç—Å–∞–µ—Ç—Å—è –∏–º—è —Å—Ç—Ä–∞–Ω—ã{
      AUSTRALIA: 'countryRef_australia',
      CANADA: 'countryRef_canada',
      NEWZEALAND: 'countryRef_newzealand',
      USA: 'countryRef_usa'
      }



  travelDetails = [
    { 
        country: "Germany",
        reason: reasonForVisit_tourism,
        arrivalDate: { month: "01", year: "2020" },
        howLong: –±—É–¥–µ—Ç –±—Ä–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –Ω–∞—á–∞–ª—å–Ω—ã–º –∏ –∫–æ–Ω–µ—á–Ω—ã–º –¥–Ω–µ–º –∏ –±—É–¥–µ—Ç –≤–≤–æ–¥–∏—Ç—å –ø–µ—Ä–∏–æ–¥ –ø—Ä–∏–±—ã–≤–∞–Ω–∏—è –≤ –¥–Ω—è—Ö ("howLong": { "type": " ", "amount": "" },)
    }];
    
  
  –¢–µ–ø–µ—Ä—å –ø–æ–π–¥—É—Ç –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω—ã –∏ —Ç—ã –±—É–¥–µ—à—å –∏—Ö –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–æ—Ç —Ç–∞–∫ –∫–∞–∫ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π 
  worldTravelCount = –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å –∫–æ–ª-–≤–æ —Å—Ç—Ä–∞–Ω –ø–æ—Å–µ—Ç–∏–≤—â–∏—Ö –∏–∑ —Å–ø–∏—Å–∫–∞ travels
  –ê —Ç–∞–∫–∂–µ —Å—Ç—Ä–∞–Ω—ã –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–ø–∏—Å–∞–Ω—ã —Å–æ–∫—Ä–∞—â–µ–Ω–æ –ø–∏—à–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –û–ê–≠ - –û–±—ä–µ–¥–∏–Ω–µ–Ω—ã–µ –ê—Ä–∞–±—Å–∫–∏–µ –≠–º–∏—Ä–∞—Ç—ã –∏ —Ç–¥ –∏ —Ç–ø
  travels = [
    {
        country: "Kyrgyzstan",
        reason: reasonForVisit_tourism,
        startDate: { day: "01", month: "01", year: "2020" },
        endDate: { day: "01", month: "01", year: "2024" }
    }];

    –ò –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π —Ä–æ–¥–∏—Ç–µ–ª–µ–π —Å –ø–æ–ª—è —Ä–æ–¥–∏—Ç–µ–ª–∏
    motherName = 'Alaska'; –∏–º—è –º–∞–º—ã
    mother_familyName = 'ABu'; —Ñ–∞–º–∏–ª–∏—è –º–∞–º—ã
    mother_DateOfBirth = { day: "01", month: "01", year: "2002" };
    mother_Country = 'Kazakhstan';
    isMotherSameCountry = true; —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –≤—Å–µ–≥–¥–∞ true
    mother_BornCountry = 'Kazakhstan';
    fatherName = 'Alaska';
    father_familyName = 'ABu';
    father_DateOfBirth = { day: "01", month: "01", year: "2002" };
    father_Country = 'Kazakhstan';
    isFatherSameCountry = true; —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –≤—Å–µ–≥–¥–∞ true
    father_BornCountry = 'Kazakhstan'; 
    moneySpendMonth =  "–±–µ—Ä–∏ —Å –ø–æ–ª—è –°–∫–æ–ª—å–∫–æ —Ç—Ä–∞—Ç–∏—Ç–µ –µ–∂–µ–º–µ—Å—è—á–Ω–æ –∏ –¥–µ–ª–∏ —ç—Ç–æ —á–∏—Å–ª–æ –Ω–∞ 627, –∏ –≤—ã–≤–æ–¥–∏ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ" 
  





}
\`\`\`

üìã **–ê–Ω–∫–µ—Ç–∞ (—Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ):**  
${JSON.stringify(finalFormData, null, 2)}
    `;

        const apiResponse = await axios.post(
            'https://api.openai.com/v1/chat/completions',
            {
                model: 'gpt-4o',
                messages: [
                    { role: "system", content: "–¢—ã –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∞–Ω–∫–µ—Ç—É –≤ JSON-—Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ." },
                    { role: "user", content: prompt2 }
                ],
                temperature: 0.1,
            },
            {
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${process.env.OPENAI_API_KEY}` }
            }
        );

        let gptResponse = apiResponse.data.choices[0].message.content;
        console.log("GPT-–æ—Ç–≤–µ—Ç (–¥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞):", gptResponse);

        // –£–¥–∞–ª—è–µ–º ```json ``` –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ª–∏—à–Ω–∏–µ —Å–∏–º–≤–æ–ª—ã
        gptResponse = gptResponse.replace(/```json/g, "").replace(/```/g, "").trim();

        if (!gptResponse || gptResponse === "{}") {
            console.error("üö® –û—à–∏–±–∫–∞: GPT –≤–µ—Ä–Ω—É–ª –ø—É—Å—Ç–æ–π JSON.");
            return res.status(500).json({ reply: '–û—à–∏–±–∫–∞: –ø–æ–ª—É—á–µ–Ω—ã –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ.' });
        }

        let formattedData;
        try {
            formattedData = JSON.parse(gptResponse);
        } catch (e) {
            console.error("üö® –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:", e);
            return res.status(500).json({ reply: '–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON.' });
        }

        console.log('üü¢ –§–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫–ª—é—á: –∑–Ω–∞—á–µ–Ω–∏–µ):', formattedData);


        // üîπ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ uk_try_with_post.js
        const updateResponse = await axios.post('http://localhost:4000/updateData', formattedData, {
            headers: { 'Content-Type': 'application/json' }
        });

        console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ uk_try_with_post.js:', updateResponse.data);

        // üîπ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—Å–∫–∞–µ–º Puppeteer
        const scriptResponse = await axios.post('http://localhost:4000/run-script', {}, {
            headers: { 'Content-Type': 'application/json' }
        });

        console.log('‚úÖ Puppeteer-—Å–∫—Ä–∏–ø—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω:', scriptResponse.data);

        res.json({
            reply: formattedData,
            message: '–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏ —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω.',
            response: scriptResponse.data
        });

    } catch (error) {
        console.error("üö® –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ JSON:", error.response ? error.response.data : error.message);
        res.status(500).json({ reply: '–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.' });
    }

});

app.post('/finalSubmit', async (req, res) => {
    try {
        console.log("üü° –ó–∞–ø—Ä–æ—Å –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—É—á–µ–Ω...");

        // –í—ã–∑—ã–≤–∞–µ–º /finalProcess, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        const finalProcessResponse = await fetch('http://localhost:3000/finalProcess', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ updatedForm: userFormData })
        });

        const finalData = await finalProcessResponse.json();

        if (!finalData.reply) {
            console.error('–û—à–∏–±–∫–∞: —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã.');
            return res.status(500).json({ message: '–û—à–∏–±–∫–∞: —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã.' });
        }

        console.log('–§–∏–Ω–∞–ª—å–Ω—ã–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:', finalData.reply);

        // –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –µ—Å–ª–∏ —á—Ç–æ
        const response = await fetch('http://localhost:4000/updateData', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(finalData.reply)
        });

        const responseData = await response.json();
        console.log("üéâ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã:", responseData);

        res.json({ message: '–§–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã.', response: responseData });

    } catch (error) {
        console.error('üö® –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö:', error);
        res.status(500).json({ message: '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö.' });
    }
});

app.listen(PORT, () => {
    console.log(`üöÄ Server is running on port ${PORT}`);
});
